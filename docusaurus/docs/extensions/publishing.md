# Publishing an Extension

## Manually Publishing an Extension

Publishing a release into a registry of your choice can be accomplished with the `publish-pkgs` script declared in your extension's `package.json`. This script will build a Docker image for each extension package, as well as a Helm chart that can be used to deploy the images. Given the option, the script can automatically push the built images and chart into a specified registry.

### Prerequisites

You will need [Docker](https://docs.docker.com/get-docker/) installed on the machine you wish to publish from, and a registry that will house your images.

## Running the Publish Script

___Usage___
```sh
Usage: ./node_modules/@rancher/shell/scripts/extension/publish [<options>] [plugins]
 options:
  -p           Push container images on build
  -f           Force building the chart even if it already exists
  -r <name>    Specify destination container registry for built images
  -o <name>    Specify destination container registry organization for built images
  -i <prefix>  Specify prefix for the built container image (default: 'ui-extension-')
  -c           Build as a container image rather than publishing to Github
  -s <repo>    Specify destination GitHub repository (org/name) - defaults to the git origin
  -b <branch>  Specify destination GitHub branch
```

You can simply run the `publish-pkgs` script with the option `-c` to have images built without specifying the registry or image names. The image names will be generated by the repository organization and the package name (e.g. `my-org/test-pkg:0.1.0`).

```sh
yarn publish-pkgs -c
```

To publish to a specific registry you will need to pass the Registry and Organization arguments:

```sh
yarn publish-pkgs -r <REGISTRY> -o <ORGANIZATION> -c
```

Running any of the commands above will only build your images - in order to publish the images to your registry you will need to either push them manually or you can run the script with the `-p` option. This will automatically push your images to the specified registry.

```sh
yarn publish-pkgs -r <REGISTRY> -o <ORGANIZATION> -p -c
```

## Additional Information

You can find more info in [this repository](https://github.com/rancher/ui-plugin-server#ui-plugin-server) on how the image build is accomplished.
