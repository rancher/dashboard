import { Canvas, Meta } from "@storybook/addon-docs";
import * as FormInput from './FormInput.stories';
import * as FormNested from './FormNested.stories';
import * as FormComponent from './FormComponent.stories';

<Meta title="Foundation/Form Validation"  />

# Form Validation

Form validation based on the library [`vee-validate`](https://github.com/logaretm/vee-validate/). [Check here](https://vee-validate.logaretm.com/v4/guide/) for documentation.

## Composition API

For the [Composition API](https://vee-validate.logaretm.com/v4/guide/composition-api/getting-started/) we will have to define everything in the setup, e.g.:

Example of configuration with custom defined rules a during declaration:

```ts
setup() {
  const { errors: errVal, values, meta } = useForm({
    validationSchema: { name: (val: string) => val !== '' ? true : 'Field is required' },
    initialValues:    { name: '' },
  });
  const [name] = defineField('name');

  return {
    name,
    values,
    errVal,
    meta,
  };
},
```

Example of configuration using existing rules:

```ts
import formRulesGenerator from '@shell/utils/validators/formRules/index';

setup() {
  const store = useStore();
  const { t } = useI18n(store);
  const validators = (key: string) => formRulesGenerator(t, { key });
  const {
    errors: errVal, values, meta, defineField
  } = useForm({
    validationSchema: { name: (val: string) => validators('name').required(val) ?? true },
    initialValues:    { name: '' },
  });
  const [name, nameAttrs] = defineField('name');

  return {
    name,
    nameAttrs,
    values,
    errVal,
    meta,
    args
  };
},
```

### Input

Case of input with validation based on [input component](/docs/stories-form-input--docs) and [existing rules](https://github.com/rancher/dashboard/blob/master/shell/utils/validators/formRules/index.ts).

<Canvas of={FormInput.Default} />

### Nested Form 

Form validation with nested cases as in Workloads using [Tabs](/docs/stories-components-tab--docs).

<Canvas of={FormNested.Default} />

### Form with custom Component

<Canvas of={FormComponent.Default} />
